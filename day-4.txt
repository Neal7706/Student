SQL> select * from Loans;

   LOAN_ID  MEMBER_ID    BOOK_ID   STAFF_ID LOAN_DATE RETURN_DA                 
---------- ---------- ---------- ---------- --------- ---------                 
         1          1          1          1 20-SEP-25 27-SEP-25                 
         2          2          2          2 21-SEP-25 28-SEP-25                 

SQL> select * from Fines;

   FINE_ID    LOAN_ID     AMOUNT P                                              
---------- ---------- ---------- -                                              
         1          1         50 N                                              
         2          2         75 Y                                              

SQL> set linesize 500;
SQL> select * from Staff;

  STAFF_ID NAME                                                                                                 ROLE                                               HIRE_DATE                                                                                                                                                                                                                                                                                                                                        
---------- ---------------------------------------------------------------------------------------------------- -------------------------------------------------- ---------                                                                                                                                                                                                                                                                                                                                        
       111 Soham                                                                                                Accountant                                         10-DEC-12                                                                                                                                                                                                                                                                                                                                        
       112 Anil                                                                                                 Sales                                              11-SEP-12                                                                                                                                                                                                                                                                                                                                        
         1 Anil Kumar                                                                                           Librarian                                          01-MAR-22                                                                                                                                                                                                                                                                                                                                        
         2 Soham Desai                                                                                          Assistant                                          15-JUN-23                                                                                                                                                                                                                                                                                                                                        

SQL> set linesize 500;
SQL> select * from Books;

   BOOK_ID TITLE                                                                                                                                                                                                    AUTHOR                                                                                               PUBLISHED_YEAR GENRE                                                                                                                                                                       
---------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------- -------------- --------------------------------------------------                                                                                                                          
       101 I                                                                                                                                                                                                        BOB                                                                                                           -2008 Autobiography                                                                                                                                                               
       102 Bloopers                                                                                                                                                                                                 Alice                                                                                                         -1987 Comedy                                                                                                                                                                      
       103 Hereditary                                                                                                                                                                                               Alex                                                                                                          -1981 Horror                                                                                                                                                                      
       201 Mathematics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       202 Physics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       203 Chemistry                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       204 Biology                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
         1 Introduction to SQL                                                                                                                                                                                      John Doe                                                                                                       2020 Education                                                                                                                                                                   
         2 Learning Python                                                                                                                                                                                          Jane Smith                                                                                                     2021 Programming                                                                                                                                                                 

9 rows selected.

SQL> select * from Members;

 MEMBER_ID NAME                                                                                                 EMAIL                                                                                                PHONE           JOIN_DATE                                                                                                                                                                                                                                                                      
---------- ---------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------- --------------- ---------                                                                                                                                                                                                                                                                      
         1 Rahul Sharma                                                                                         rahul@gmail.com                                                                                      9876543210      10-JAN-25                                                                                                                                                                                                                                                                      
         2 Sneha Patil                                                                                          sneha@gmail.com                                                                                      9123456780      15-FEB-25                                                                                                                                                                                                                                                                      

SQL> select * from Members;

 MEMBER_ID NAME                                                                                                 EMAIL                                                                                                PHONE           JOIN_DATE                                                                                                                                                                                                                                                                      
---------- ---------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------- --------------- ---------                                                                                                                                                                                                                                                                      
         1 Rahul Sharma                                                                                         rahul@gmail.com                                                                                      9876543210      10-JAN-25                                                                                                                                                                                                                                                                      
         2 Sneha Patil                                                                                          sneha@gmail.com                                                                                      9123456780      15-FEB-25                                                                                                                                                                                                                                                                     

SQL> desc Fines;
 Name                                                                                                                                                                                                                                                                                                  Null?    Type
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 FINE_ID                                                                                                                                                                                                                                                                                               NOT NULL NUMBER(38)
 LOAN_ID                                                                                                                                                                                                                                                                                                        NUMBER(38)
 AMOUNT                                                                                                                                                                                                                                                                                                         NUMBER(6,2)
 PAID                                                                                                                                                                                                                                                                                                           CHAR(1)

SQL> DESC Fines;
 Name                                                                                                                                                                                                                                                                                                  Null?    Type
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 FINE_ID                                                                                                                                                                                                                                                                                               NOT NULL NUMBER(38)
 LOAN_ID                                                                                                                                                                                                                                                                                                        NUMBER(38)
 AMOUNT                                                                                                                                                                                                                                                                                                         NUMBER(6,2)
 PAID                                                                                                                                                                                                                                                                                                           CHAR(1)

SQL> SELECT
  2      LOAN_ID,
  3      COUNT(*) AS Total_Fines,
  4      SUM(AMOUNT) AS Total_Amount,
  5      AVG(AMOUNT) AS Avg_Amount,
  6      MAX(AMOUNT) AS Max_Amount,
  7      MIN(AMOUNT) AS Min_Amount
  8  FROM Fines
  9  GROUP BY LOAN_ID
 10  HAVING SUM(AMOUNT) > 5;

   LOAN_ID TOTAL_FINES TOTAL_AMOUNT AVG_AMOUNT MAX_AMOUNT MIN_AMOUNT                                                                                                                                                                                                                                                                                                                                                                                                                                                
---------- ----------- ------------ ---------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                
         1           1           50         50         50         50                                                                                                                                                                                                                                                                                                                                                                                                                                                
         2           1           75         75         75         75                                                                                                                                                                                                                                                                                                                                                                                                                                                

SQL> commit;

Commit complete.

SQL> spool off;
